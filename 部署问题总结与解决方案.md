# Railway + Vercel éƒ¨ç½²é—®é¢˜æ€»ç»“ä¸è§£å†³æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°ï¼š** ç¾å‰§å•è¯å­¦ä¹ åŠ©æ‰‹  
**å‰ç«¯ï¼š** Vue 3 + Vite â†’ Vercel  
**åç«¯ï¼š** Flask + Python â†’ Railway  
**éƒ¨ç½²æ—¶é—´ï¼š** 2025-11-12  
**éƒ¨ç½²çŠ¶æ€ï¼š** âœ… æˆåŠŸ

---

## ğŸ¯ éƒ¨ç½²æ¶æ„

```
GitHub ä»“åº“
    â”œâ”€â”€ backend/           â†’ Railway éƒ¨ç½²
    â”‚   â”œâ”€â”€ app/
    â”‚   â”œâ”€â”€ config.py
    â”‚   â”œâ”€â”€ run.py
    â”‚   â””â”€â”€ requirements.txt
    â””â”€â”€ frontend/          â†’ Vercel éƒ¨ç½²
        â”œâ”€â”€ src/
        â”œâ”€â”€ package.json
        â””â”€â”€ vercel.json
```

**æœ€ç»ˆéƒ¨ç½²ç»“æœï¼š**
- åç«¯ï¼š`https://rare-wonder-production.up.railway.app`
- å‰ç«¯ï¼š`https://learning-english-when-whaching-tv.vercel.app`

---

## ğŸ› éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜

### é—®é¢˜ 1ï¼šconfig.py è¢« .gitignore å¿½ç•¥

#### âŒ é”™è¯¯ç°è±¡

Railway éƒ¨ç½²æ—¥å¿—æ˜¾ç¤ºï¼š
```
ImportError: No module named 'config'
ModuleNotFoundError: No module named 'config'
Cannot find config.py in /app
```

#### ğŸ” åŸå› åˆ†æ

1. æ ¹ç›®å½•çš„ `.gitignore` æ–‡ä»¶ç¬¬ 79 è¡ŒåŒ…å« `config.py`
2. å¯¼è‡´ `backend/config.py` æ²¡æœ‰è¢«ä¸Šä¼ åˆ° GitHub
3. Railway ä» GitHub æ‹‰å–ä»£ç æ—¶è‡ªç„¶æ‰¾ä¸åˆ°è¿™ä¸ªæ–‡ä»¶

#### âœ… è§£å†³æ–¹æ¡ˆ

**ä¿®æ”¹ `.gitignore`ï¼š**

```diff
# API Keys
- config.py
+ # config.py  # å·²ç§»é™¤ï¼Œå› ä¸ºæ•æ„Ÿä¿¡æ¯éƒ½ä½¿ç”¨ç¯å¢ƒå˜é‡
.env.local
.env.*.local
```

**åŸç†è¯´æ˜ï¼š**
- `backend/config.py` ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯
- æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ç¡¬ç¼–ç çš„å¯†é’¥
- å¯ä»¥å®‰å…¨åœ°ä¸Šä¼ åˆ° GitHub

**éªŒè¯æ–¹æ³•ï¼š**
```bash
git ls-files backend/config.py
# åº”è¯¥è¾“å‡º: backend/config.py
```

---

### é—®é¢˜ 2ï¼šRailway é…ç½®æ–‡ä»¶ä½ç½®å’Œå†…å®¹é”™è¯¯

#### âŒ é”™è¯¯ç°è±¡

Railway æ‰¾ä¸åˆ°æ­£ç¡®çš„å¯åŠ¨å‘½ä»¤å’Œæ„å»ºé…ç½®ã€‚

#### ğŸ” åŸå› åˆ†æ

1. é…ç½®æ–‡ä»¶ä½ç½®æ··ä¹±ï¼š
   - `backend/railway.json` âŒï¼ˆé”™è¯¯ä½ç½®ï¼‰
   - åº”è¯¥åœ¨æ ¹ç›®å½• âœ…

2. å¯åŠ¨å‘½ä»¤ä¸å®Œæ•´ï¼š
   - ç¼ºå°‘ `cd backend` åˆ‡æ¢ç›®å½•
   - ç¼ºå°‘ç«¯å£ç»‘å®šå‚æ•°

#### âœ… è§£å†³æ–¹æ¡ˆ

**1. åœ¨æ ¹ç›®å½•åˆ›å»º `railway.json`ï¼š**

```json
{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "cd backend && gunicorn run:app --bind 0.0.0.0:$PORT",
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

**2. æ›´æ–° `railway.toml`ï¼š**

```toml
[build]
builder = "NIXPACKS"

[deploy]
startCommand = "cd backend && gunicorn run:app --bind 0.0.0.0:$PORT"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
```

**3. åœ¨æ ¹ç›®å½•åˆ›å»ºå¿…è¦æ–‡ä»¶ï¼š**

- `runtime.txt`ï¼šæŒ‡å®š Python ç‰ˆæœ¬
- `requirements.txt`ï¼šåˆ—å‡ºä¾èµ–åŒ…
- `Procfile`ï¼šå®šä¹‰å¯åŠ¨å‘½ä»¤

---

### é—®é¢˜ 3ï¼šPython ç‰ˆæœ¬ä¸å…¼å®¹

#### âŒ é”™è¯¯ç°è±¡

Railway æ„å»ºæ—¥å¿—æ˜¾ç¤ºï¼š
```
mise ERROR no precompiled python found for core:python@3.11.0 on x86_64-unknown-linux-gnu
mise ERROR failed to install core:python@3.11.0
```

#### ğŸ” åŸå› åˆ†æ

1. `backend/runtime.txt` æœ€åˆæŒ‡å®šäº† `python-3.11.0`
2. åæ¥æ”¹æˆäº† `python-3.11.10`
3. **Railpack æ„å»ºå™¨æ‰¾ä¸åˆ°è¿™äº›ç²¾ç¡®ç‰ˆæœ¬çš„é¢„ç¼–è¯‘åŒ…**
4. Railway åŒæ—¶è¯»å–äº†æ ¹ç›®å½•å’Œ `backend/` ç›®å½•çš„ `runtime.txt`ï¼Œäº§ç”Ÿå†²çª

#### âœ… è§£å†³æ–¹æ¡ˆ

**ç»Ÿä¸€ Python ç‰ˆæœ¬é…ç½®ï¼š**

**æ ¹ç›®å½• `runtime.txt`ï¼š**
```txt
python-3.11
```

**`backend/runtime.txt`ï¼š**
```txt
python-3.11
```

**å…³é”®ç‚¹ï¼š**
- âœ… ä½¿ç”¨ `python-3.11`ï¼ˆé€šç”¨ç‰ˆæœ¬å·ï¼‰
- âŒ ä¸è¦ç”¨ `python-3.11.0` æˆ– `python-3.11.10`ï¼ˆç²¾ç¡®ç‰ˆæœ¬ï¼‰
- âœ… Railway ä¼šè‡ªåŠ¨é€‰æ‹©å¯ç”¨çš„ 3.11.x ç‰ˆæœ¬ï¼ˆå®é™…ä½¿ç”¨äº† 3.11.14ï¼‰

**æœ€ç»ˆç»“æœï¼š**
```
âœ… mise python@3.11.14 âœ“ installed
```

---

### é—®é¢˜ 4ï¼šCORS è·¨åŸŸé…ç½®ç¼ºå¤±

#### âŒ é”™è¯¯ç°è±¡

å‰ç«¯é¡µé¢æ˜¾ç¤ºï¼š
- "åŠ è½½æ¦‚è§ˆå¤±è´¥"
- "åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥"
- "æŸ¥è¯¢å¤±è´¥: Network Error"

æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ï¼š
```
Access to XMLHttpRequest at 'https://rare-wonder-production.up.railway.app/api/...' 
from origin 'https://learning-english-when-whaching-tv.vercel.app' 
has been blocked by CORS policy: 
No 'Access-Control-Allow-Origin' header is present on the requested resource.
```

#### ğŸ” åŸå› åˆ†æ

1. **Railway ä¸­æ²¡æœ‰è®¾ç½® `CORS_ORIGINS` ç¯å¢ƒå˜é‡**
2. åç«¯ä»£ç é»˜è®¤åªå…è®¸æœ¬åœ°è®¿é—®ï¼š
   ```python
   CORS_ORIGINS = os.getenv('CORS_ORIGINS', 'http://localhost:5173,http://localhost:3000').split(',')
   ```
3. å‰ç«¯ï¼ˆVercelï¼‰çš„è¯·æ±‚è¢«åç«¯æ‹’ç»

#### âœ… è§£å†³æ–¹æ¡ˆ

**åœ¨ Railway ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š**

1. æ‰“å¼€ Railway é¡¹ç›®
2. ç‚¹å‡» `rare-wonder` æœåŠ¡
3. ç‚¹å‡» `Variables` æ ‡ç­¾
4. æ·»åŠ å˜é‡ï¼š

```bash
Name:  CORS_ORIGINS
Value: https://learning-english-when-whaching-tv.vercel.app,http://localhost:5173
```

**é…ç½®è¦ç‚¹ï¼š**
- âœ… ä½¿ç”¨ `https://`ï¼ˆVercel ä½¿ç”¨ HTTPSï¼‰
- âœ… åŸŸåå®Œå…¨åŒ¹é…
- âœ… å¤šä¸ªåŸŸåç”¨é€—å·åˆ†éš”
- âŒ é€—å·åé¢ä¸è¦æœ‰ç©ºæ ¼
- âŒ æœ€åä¸è¦åŠ æ–œæ  `/`

**ä¿å­˜åï¼š**
- Railway è‡ªåŠ¨æ£€æµ‹å˜åŒ–
- è§¦å‘é‡æ–°éƒ¨ç½²ï¼ˆ1-2 åˆ†é’Ÿï¼‰
- å‰ç«¯åˆ·æ–°åæ­£å¸¸å·¥ä½œ

---

### é—®é¢˜ 5ï¼šå‰ç«¯ API åœ°å€é…ç½®é”™è¯¯

#### âŒ é”™è¯¯ç°è±¡

å‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯ APIã€‚

#### ğŸ” åŸå› åˆ†æ

1. `frontend/vercel.json` ä¸­çš„åç«¯ URL æ˜¯å ä½ç¬¦ï¼š
   ```json
   "destination": "https://your-backend-url.railway.app/api/:path*"
   ```

2. Vercel ç¯å¢ƒå˜é‡æœªè®¾ç½®æˆ–é…ç½®é”™è¯¯

#### âœ… è§£å†³æ–¹æ¡ˆ

**1. æ›´æ–° `frontend/vercel.json`ï¼š**

```json
{
  "version": 2,
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "framework": "vite",
  "rewrites": [
    {
      "source": "/api/:path*",
      "destination": "https://rare-wonder-production.up.railway.app/api/:path*"
    },
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

**2. åœ¨ Vercel ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼š**

```bash
Name:  VITE_API_BASE_URL
Value: https://rare-wonder-production.up.railway.app
```

**æ³¨æ„ï¼š**
- âœ… URL ä¸è¦ä»¥æ–œæ ç»“å°¾
- âœ… ä¸è¦åœ¨ URL åé¢åŠ  `/api`ï¼ˆä»£ç ä¼šè‡ªåŠ¨æ·»åŠ ï¼‰

---

## âœ… æœ€ç»ˆé…ç½®æ¸…å•

### Railway ç¯å¢ƒå˜é‡

```bash
# å¿…éœ€é…ç½®
SECRET_KEY=<ä½¿ç”¨ python -c "import secrets; print(secrets.token_hex(32))" ç”Ÿæˆ>
FLASK_ENV=production
CORS_ORIGINS=https://learning-english-when-whaching-tv.vercel.app,http://localhost:5173

# å¯é€‰é…ç½®ï¼ˆæœ‰é“ç¿»è¯‘ APIï¼‰
YOUDAO_APP_KEY=<ä½ çš„ API Key>
YOUDAO_APP_SECRET=<ä½ çš„ API Secret>
```

### Vercel ç¯å¢ƒå˜é‡

```bash
VITE_API_BASE_URL=https://rare-wonder-production.up.railway.app
```

### å…³é”®é…ç½®æ–‡ä»¶

#### æ ¹ç›®å½•æ–‡ä»¶

**`runtime.txt`ï¼š**
```txt
python-3.11
```

**`requirements.txt`ï¼š**
```txt
Flask==3.0.0
Flask-CORS==4.0.0
Flask-SQLAlchemy==3.1.1
requests==2.31.0
python-dotenv==1.0.0
gunicorn==21.2.0
```

**`Procfile`ï¼š**
```txt
web: cd backend && gunicorn run:app --bind 0.0.0.0:$PORT
```

**`railway.json`ï¼š**
```json
{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "cd backend && gunicorn run:app --bind 0.0.0.0:$PORT",
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

#### å‰ç«¯é…ç½®

**`frontend/vercel.json`ï¼š**
```json
{
  "version": 2,
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "framework": "vite",
  "rewrites": [
    {
      "source": "/api/:path*",
      "destination": "https://rare-wonder-production.up.railway.app/api/:path*"
    },
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

---

## ğŸ¯ éƒ¨ç½²æœ€ä½³å®è·µ

### 1. ç¯å¢ƒå˜é‡ç®¡ç†

**âœ… æ¨èåšæ³•ï¼š**
- æ‰€æœ‰æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡
- é…ç½®æ–‡ä»¶åªåŒ…å«ä»£ç é€»è¾‘
- ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„ç¯å¢ƒå˜é‡

**âŒ é¿å…ï¼š**
- åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
- å°†åŒ…å«å¯†é’¥çš„é…ç½®æ–‡ä»¶ä¸Šä¼ åˆ° Git

### 2. Python ç‰ˆæœ¬æŒ‡å®š

**âœ… æ¨èåšæ³•ï¼š**
```txt
python-3.11
python-3.10
```

**âŒ é¿å…ï¼š**
```txt
python-3.11.0
python-3.11.10
```

**åŸå› ï¼š**
- ç²¾ç¡®ç‰ˆæœ¬å¯èƒ½æ²¡æœ‰é¢„ç¼–è¯‘åŒ…
- é€šç”¨ç‰ˆæœ¬å·è®©å¹³å°è‡ªåŠ¨é€‰æ‹©æœ€ä½³ç‰ˆæœ¬

### 3. CORS é…ç½®

**âœ… æ¨èåšæ³•ï¼š**
```python
# ä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œæ”¯æŒå¤šä¸ªåŸŸå
CORS_ORIGINS = os.getenv('CORS_ORIGINS', 'http://localhost:5173').split(',')
```

**é…ç½®æ ¼å¼ï¼š**
```bash
https://your-app.vercel.app,http://localhost:5173
```

**æ³¨æ„ï¼š**
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPS
- ä¿ç•™æœ¬åœ°å¼€å‘çš„ localhost
- é€—å·åˆ†éš”ï¼Œæ— ç©ºæ ¼

### 4. é…ç½®æ–‡ä»¶ä½ç½®

**Railway é¡¹ç›®ç»“æ„ï¼š**
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ railway.json       âœ… Railway é…ç½®
â”œâ”€â”€ railway.toml       âœ… å¤‡ç”¨é…ç½®
â”œâ”€â”€ runtime.txt        âœ… Python ç‰ˆæœ¬
â”œâ”€â”€ requirements.txt   âœ… ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ Procfile          âœ… å¯åŠ¨å‘½ä»¤
â””â”€â”€ backend/          âœ… åº”ç”¨ä»£ç 
    â”œâ”€â”€ app/
    â”œâ”€â”€ config.py
    â”œâ”€â”€ run.py
    â””â”€â”€ requirements.txt  âœ… ä¿ç•™å¤‡ä»½
```

### 5. Git ç‰ˆæœ¬æ§åˆ¶

**åº”è¯¥æäº¤çš„æ–‡ä»¶ï¼š**
- âœ… `config.py`ï¼ˆä½¿ç”¨ç¯å¢ƒå˜é‡çš„é…ç½®æ–‡ä»¶ï¼‰
- âœ… `requirements.txt`
- âœ… `runtime.txt`
- âœ… `railway.json`
- âœ… æ‰€æœ‰åº”ç”¨ä»£ç 

**åº”è¯¥å¿½ç•¥çš„æ–‡ä»¶ï¼š**
- âŒ `.env`ï¼ˆåŒ…å«å®é™…å¯†é’¥çš„æ–‡ä»¶ï¼‰
- âŒ `*.db`ï¼ˆæ•°æ®åº“æ–‡ä»¶ï¼‰
- âŒ `__pycache__/`
- âŒ `node_modules/`

---

## ğŸ” é—®é¢˜è¯Šæ–­æ¸…å•

### å½“éƒ¨ç½²å¤±è´¥æ—¶ï¼ŒæŒ‰ç…§ä»¥ä¸‹é¡ºåºæ£€æŸ¥ï¼š

#### 1. Railway æ„å»ºå¤±è´¥

**æ£€æŸ¥é¡¹ï¼š**
```bash
[ ] config.py æ˜¯å¦åœ¨ Git ä¸­ï¼Ÿ
    â†’ git ls-files backend/config.py

[ ] runtime.txt Python ç‰ˆæœ¬æ­£ç¡®ï¼Ÿ
    â†’ åº”è¯¥æ˜¯ python-3.11ï¼Œä¸æ˜¯ python-3.11.0

[ ] requirements.txt å­˜åœ¨ä¸”æ­£ç¡®ï¼Ÿ
    â†’ æ£€æŸ¥æ‰€æœ‰ä¾èµ–åŒ…

[ ] é…ç½®æ–‡ä»¶ä½ç½®æ­£ç¡®ï¼Ÿ
    â†’ railway.json åœ¨æ ¹ç›®å½•
```

#### 2. Railway éƒ¨ç½²æˆåŠŸä½†æ— æ³•è®¿é—®

**æ£€æŸ¥é¡¹ï¼š**
```bash
[ ] æœåŠ¡çŠ¶æ€æ˜¯ Activeï¼Ÿ
    â†’ Railway â†’ Deployments

[ ] åŸŸåå·²ç”Ÿæˆï¼Ÿ
    â†’ Railway â†’ Settings â†’ Networking

[ ] ç¯å¢ƒå˜é‡å·²è®¾ç½®ï¼Ÿ
    â†’ Railway â†’ Variables
    â†’ SECRET_KEY, FLASK_ENV, CORS_ORIGINS
```

#### 3. å‰ç«¯æ— æ³•è¿æ¥åç«¯ï¼ˆCORS é”™è¯¯ï¼‰

**æ£€æŸ¥é¡¹ï¼š**
```bash
[ ] Railway æœ‰ CORS_ORIGINS å˜é‡ï¼Ÿ
    â†’ å¿…é¡»åŒ…å«å‰ç«¯åŸŸå

[ ] CORS_ORIGINS æ ¼å¼æ­£ç¡®ï¼Ÿ
    â†’ https://your-app.vercel.app,http://localhost:5173
    â†’ ä½¿ç”¨ httpsï¼Œæ— ç©ºæ ¼ï¼Œæ— å°¾éƒ¨æ–œæ 

[ ] Railway å·²é‡æ–°éƒ¨ç½²ï¼Ÿ
    â†’ ä¿®æ”¹å˜é‡åéœ€è¦ç­‰å¾…éƒ¨ç½²

[ ] æµè§ˆå™¨ç¼“å­˜å·²æ¸…é™¤ï¼Ÿ
    â†’ Ctrl+Shift+R å¼ºåˆ¶åˆ·æ–°
```

#### 4. Vercel éƒ¨ç½²å¤±è´¥

**æ£€æŸ¥é¡¹ï¼š**
```bash
[ ] é€‰æ‹©äº† frontend ç›®å½•ï¼Ÿ
    â†’ Root Directory: frontend

[ ] ç¯å¢ƒå˜é‡å·²è®¾ç½®ï¼Ÿ
    â†’ VITE_API_BASE_URL

[ ] vercel.json é…ç½®æ­£ç¡®ï¼Ÿ
    â†’ åç«¯ URL æŒ‡å‘ Railway
```

---

## ğŸ“Š é—®é¢˜ä¼˜å…ˆçº§å’Œè§£å†³æ—¶é—´

| é—®é¢˜ | ä¸¥é‡ç¨‹åº¦ | è§£å†³æ—¶é—´ | éš¾åº¦ |
|------|---------|---------|------|
| config.py è¢«å¿½ç•¥ | ğŸ”´ è‡´å‘½ | 5 åˆ†é’Ÿ | ç®€å• |
| Python ç‰ˆæœ¬é”™è¯¯ | ğŸ”´ è‡´å‘½ | 10 åˆ†é’Ÿ | ä¸­ç­‰ |
| é…ç½®æ–‡ä»¶ä½ç½®é”™è¯¯ | ğŸŸ¡ ä¸¥é‡ | 15 åˆ†é’Ÿ | ä¸­ç­‰ |
| CORS é…ç½®ç¼ºå¤± | ğŸŸ¡ ä¸¥é‡ | 5 åˆ†é’Ÿ | ç®€å• |
| å‰ç«¯ API åœ°å€é”™è¯¯ | ğŸŸ¡ ä¸¥é‡ | 5 åˆ†é’Ÿ | ç®€å• |

**æ€»è®¡è§£å†³æ—¶é—´ï¼š** çº¦ 40 åˆ†é’Ÿ

**å®é™…éƒ¨ç½²æ—¶é—´ï¼š** çº¦ 2-3 å°æ—¶ï¼ˆåŒ…æ‹¬å¤šæ¬¡å°è¯•å’Œè°ƒè¯•ï¼‰

---

## ğŸš€ å®Œæ•´éƒ¨ç½²æµç¨‹ï¼ˆé¿å‘ç‰ˆï¼‰

### é˜¶æ®µ 1ï¼šå‡†å¤‡ä»£ç ï¼ˆ10 åˆ†é’Ÿï¼‰

```bash
# 1. æ£€æŸ¥ .gitignore
vim .gitignore
# ç¡®ä¿ config.py æ²¡æœ‰è¢«å¿½ç•¥

# 2. åˆ›å»ºæ ¹ç›®å½•é…ç½®æ–‡ä»¶
cat > runtime.txt << EOF
python-3.11
EOF

cat > requirements.txt << EOF
Flask==3.0.0
Flask-CORS==4.0.0
Flask-SQLAlchemy==3.1.1
requests==2.31.0
python-dotenv==1.0.0
gunicorn==21.2.0
EOF

cat > Procfile << EOF
web: cd backend && gunicorn run:app --bind 0.0.0.0:$PORT
EOF

# 3. åˆ›å»º railway.json
# è§ä¸Šé¢çš„é…ç½®æ¸…å•

# 4. æäº¤åˆ° Git
git add .
git commit -m "Prepare for Railway deployment"
git push origin main
```

### é˜¶æ®µ 2ï¼šéƒ¨ç½²åç«¯åˆ° Railwayï¼ˆ15 åˆ†é’Ÿï¼‰

```bash
# 1. ç™»å½• Railway (https://railway.app)

# 2. åˆ›å»ºæ–°é¡¹ç›®
#    â†’ New Project â†’ Deploy from GitHub repo

# 3. é€‰æ‹©ä»“åº“

# 4. é…ç½®ç¯å¢ƒå˜é‡
#    â†’ Variables æ ‡ç­¾
SECRET_KEY=<ç”Ÿæˆçš„å¯†é’¥>
FLASK_ENV=production
CORS_ORIGINS=http://localhost:5173

# 5. ç­‰å¾…éƒ¨ç½²ï¼ˆ3-5 åˆ†é’Ÿï¼‰

# 6. ç”ŸæˆåŸŸå
#    â†’ Settings â†’ Generate Domain

# 7. æµ‹è¯• API
curl https://your-app.railway.app/api/statistics/overview
```

### é˜¶æ®µ 3ï¼šéƒ¨ç½²å‰ç«¯åˆ° Vercelï¼ˆ10 åˆ†é’Ÿï¼‰

```bash
# 1. æ›´æ–° frontend/vercel.json
#    å°†åç«¯ URL æ”¹ä¸ºå®é™…çš„ Railway åŸŸå

# 2. æäº¤æ›´æ”¹
git add frontend/vercel.json
git commit -m "Update backend URL"
git push origin main

# 3. ç™»å½• Vercel (https://vercel.com)

# 4. å¯¼å…¥é¡¹ç›®
#    â†’ Add New â†’ Project â†’ Import Git Repository

# 5. é…ç½®é¡¹ç›®
#    Root Directory: frontend
#    Environment Variables:
#      VITE_API_BASE_URL=https://your-app.railway.app

# 6. éƒ¨ç½²ï¼ˆ2-3 åˆ†é’Ÿï¼‰

# 7. è·å–å‰ç«¯åŸŸå
```

### é˜¶æ®µ 4ï¼šé…ç½® CORSï¼ˆ5 åˆ†é’Ÿï¼‰

```bash
# 1. å›åˆ° Railway

# 2. æ›´æ–° CORS_ORIGINS
#    â†’ Variables
CORS_ORIGINS=https://your-app.vercel.app,http://localhost:5173

# 3. ç­‰å¾…é‡æ–°éƒ¨ç½²ï¼ˆ1-2 åˆ†é’Ÿï¼‰

# 4. æµ‹è¯•å‰ç«¯
#    è®¿é—® Vercel åŸŸåï¼Œæµ‹è¯•æ‰€æœ‰åŠŸèƒ½
```

---

## ğŸ“ ç»éªŒæ•™è®­

### 1. é…ç½®æ–‡ä»¶çš„é‡è¦æ€§

**æ•™è®­ï¼š**
- çœ‹ä¼¼ç®€å•çš„ `.gitignore` é…ç½®å¯èƒ½å¯¼è‡´ä¸¥é‡é—®é¢˜
- é…ç½®æ–‡ä»¶ä½ç½®å¾ˆé‡è¦ï¼ˆæ ¹ç›®å½• vs å­ç›®å½•ï¼‰

**å»ºè®®ï¼š**
- éƒ¨ç½²å‰æ£€æŸ¥æ‰€æœ‰é…ç½®æ–‡ä»¶æ˜¯å¦åœ¨ Git ä¸­
- ä½¿ç”¨ `git ls-files` éªŒè¯æ–‡ä»¶æ˜¯å¦è¢«è·Ÿè¸ª

### 2. ç¯å¢ƒå˜é‡çš„ä¼˜å…ˆçº§

**æ•™è®­ï¼š**
- Railway ä¼šåŒæ—¶æ£€æŸ¥å¤šä¸ª `runtime.txt`
- ç¯å¢ƒå˜é‡çš„ç¼ºå¤±ä¼šå¯¼è‡´ CORS é”™è¯¯

**å»ºè®®ï¼š**
- ç»Ÿä¸€æ‰€æœ‰é…ç½®æ–‡ä»¶çš„å†…å®¹
- å…ˆè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå†æµ‹è¯•éƒ¨ç½²

### 3. Python ç‰ˆæœ¬çš„å…¼å®¹æ€§

**æ•™è®­ï¼š**
- ç²¾ç¡®ç‰ˆæœ¬å·ï¼ˆ3.11.0ï¼‰å¯èƒ½æ‰¾ä¸åˆ°é¢„ç¼–è¯‘åŒ…
- ä¸åŒçš„æ„å»ºå™¨æœ‰ä¸åŒçš„ç‰ˆæœ¬å¯ç”¨æ€§

**å»ºè®®ï¼š**
- ä½¿ç”¨é€šç”¨ç‰ˆæœ¬å·ï¼ˆ3.11 è€Œä¸æ˜¯ 3.11.0ï¼‰
- è®©å¹³å°è‡ªåŠ¨é€‰æ‹©æœ€ä½³ç‰ˆæœ¬

### 4. CORS è°ƒè¯•çš„æ–¹æ³•

**æ•™è®­ï¼š**
- CORS é”™è¯¯å¾ˆå¸¸è§ä½†å®¹æ˜“å¿½ç•¥
- å‰ç«¯èƒ½è®¿é—®ä½†åç«¯æ‹’ç»æ˜¯å…¸å‹çš„ CORS é—®é¢˜

**å»ºè®®ï¼š**
- éƒ¨ç½²å‰ç«¯åç«‹å³é…ç½® CORS
- ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹å…·ä½“é”™è¯¯
- æµ‹è¯• CORS å“åº”å¤´æ˜¯å¦æ­£ç¡®

### 5. éƒ¨ç½²æµç¨‹çš„é¡ºåº

**æ•™è®­ï¼š**
- å…ˆéƒ¨ç½²åç«¯ï¼Œæµ‹è¯•é€šè¿‡åå†éƒ¨ç½²å‰ç«¯
- å‰ç«¯éƒ¨ç½²åéœ€è¦æ›´æ–°åç«¯çš„ CORS é…ç½®

**å»ºè®®ï¼š**
- éµå¾ªï¼šåç«¯ â†’ æµ‹è¯• â†’ å‰ç«¯ â†’ CORS â†’ æµ‹è¯•çš„é¡ºåº
- æ¯ä¸ªé˜¶æ®µå®Œæˆåéƒ½è¦éªŒè¯

---

## ğŸ“ å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤

```bash
# ç”Ÿæˆ SECRET_KEY
python -c "import secrets; print(secrets.token_hex(32))"

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åœ¨ Git ä¸­
git ls-files backend/config.py

# æµ‹è¯•åç«¯ API
curl https://rare-wonder-production.up.railway.app/api/statistics/overview

# æµ‹è¯• CORS
curl -H "Origin: https://learning-english-when-whaching-tv.vercel.app" \
  https://rare-wonder-production.up.railway.app/api/statistics/overview -I
```

### å…³é”® URL

```bash
# Railway
é¡¹ç›®: https://railway.app/
åç«¯: https://rare-wonder-production.up.railway.app

# Vercel  
é¡¹ç›®: https://vercel.com/
å‰ç«¯: https://learning-english-when-whaching-tv.vercel.app

# GitHub
ä»“åº“: https://github.com/qilirampart/Learning-English-when-whaching-Tv
```

### ç¯å¢ƒå˜é‡æ¨¡æ¿

**Railway (`rare-wonder`)ï¼š**
```bash
SECRET_KEY=<ç”Ÿæˆçš„64ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²>
FLASK_ENV=production
CORS_ORIGINS=https://learning-english-when-whaching-tv.vercel.app,http://localhost:5173
YOUDAO_APP_KEY=<å¯é€‰>
YOUDAO_APP_SECRET=<å¯é€‰>
```

**Vercel (frontend)ï¼š**
```bash
VITE_API_BASE_URL=https://rare-wonder-production.up.railway.app
```

---

## ğŸ‰ æ€»ç»“

### æˆåŠŸéƒ¨ç½²çš„å…³é”®å› ç´ 

1. âœ… **æ­£ç¡®çš„æ–‡ä»¶ç»“æ„**
   - æ ¹ç›®å½•å’Œå­ç›®å½•çš„é…ç½®æ–‡ä»¶éƒ½æ­£ç¡®
   - æ‰€æœ‰å¿…éœ€æ–‡ä»¶éƒ½åœ¨ Git ä¸­

2. âœ… **åˆé€‚çš„ Python ç‰ˆæœ¬é…ç½®**
   - ä½¿ç”¨é€šç”¨ç‰ˆæœ¬å· `python-3.11`
   - é¿å…ç²¾ç¡®ç‰ˆæœ¬å·

3. âœ… **å®Œæ•´çš„ç¯å¢ƒå˜é‡**
   - Railway å’Œ Vercel éƒ½é…ç½®æ­£ç¡®
   - CORS_ORIGINS åŒ…å«æ‰€æœ‰å…è®¸çš„åŸŸå

4. âœ… **æ­£ç¡®çš„éƒ¨ç½²é¡ºåº**
   - åç«¯å…ˆéƒ¨ç½²å¹¶æµ‹è¯•
   - å‰ç«¯éƒ¨ç½²åé…ç½® CORS
   - é€æ­¥éªŒè¯æ¯ä¸ªç¯èŠ‚

### æœ€ç»ˆæˆæœ

- âœ… åç«¯æˆåŠŸéƒ¨ç½²åˆ° Railway
- âœ… å‰ç«¯æˆåŠŸéƒ¨ç½²åˆ° Vercel
- âœ… å‰åç«¯é€šä¿¡æ­£å¸¸
- âœ… CORS é…ç½®æ­£ç¡®
- âœ… æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡

### éƒ¨ç½²è€—æ—¶ç»Ÿè®¡

| é˜¶æ®µ | è®¡åˆ’æ—¶é—´ | å®é™…æ—¶é—´ |
|------|---------|---------|
| ä»£ç å‡†å¤‡ | 10 åˆ†é’Ÿ | 15 åˆ†é’Ÿ |
| åç«¯éƒ¨ç½² | 15 åˆ†é’Ÿ | 60 åˆ†é’Ÿï¼ˆå¤šæ¬¡å°è¯•ï¼‰|
| å‰ç«¯éƒ¨ç½² | 10 åˆ†é’Ÿ | 15 åˆ†é’Ÿ |
| CORS é…ç½® | 5 åˆ†é’Ÿ | 20 åˆ†é’Ÿï¼ˆè°ƒè¯•ï¼‰|
| æ€»è®¡ | 40 åˆ†é’Ÿ | 110 åˆ†é’Ÿ |

**ä¸»è¦è€—æ—¶åŸå› ï¼š**
- Python ç‰ˆæœ¬é—®é¢˜éœ€è¦å¤šæ¬¡å°è¯•
- CORS é…ç½®ç¼ºå¤±æœªåŠæ—¶å‘ç°
- é…ç½®æ–‡ä»¶ä½ç½®è°ƒæ•´

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- [Railway å®˜æ–¹æ–‡æ¡£](https://docs.railway.app/)
- [Vercel å®˜æ–¹æ–‡æ¡£](https://vercel.com/docs)
- [Flask-CORS æ–‡æ¡£](https://flask-cors.readthedocs.io/)
- [Gunicorn æ–‡æ¡£](https://docs.gunicorn.org/)

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**åˆ›å»ºæ—¥æœŸï¼š** 2025-11-12  
**æœ€åæ›´æ–°ï¼š** 2025-11-12  
**ä½œè€…ï¼š** AI Assistant

---

**ç¥ä½ çš„é¡¹ç›®è¿è¡Œé¡ºåˆ©ï¼** ğŸ‰ğŸš€

