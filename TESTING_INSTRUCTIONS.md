# 测试说明文档

## 🚨 当前问题

系统的 pip 配置存在代理问题，无法自动安装依赖。需要您手动执行以下步骤。

---

## 📝 手动测试步骤

### 步骤 1: 安装后端依赖

**方法 A：关闭代理后安装**
```bash
# 1. 临时关闭系统代理
# 2. 打开命令行，执行：
cd C:\AIProject\backend
pip install PyJWT==2.8.0 Werkzeug==3.0.1
```

**方法 B：使用豆瓣镜像**
```bash
cd C:\AIProject\backend
pip install -i https://pypi.douban.com/simple PyJWT==2.8.0 Werkzeug==3.0.1
```

**方法 C：安装所有依赖**
```bash
cd C:\AIProject\backend
pip install -r requirements.txt
```

---

### 步骤 2: 确认数据库已删除

✅ **已完成** - 旧数据库已成功删除

---

### 步骤 3: 启动后端服务

```bash
cd C:\AIProject\backend
python run.py
```

**预期输出：**
```
 * Serving Flask app 'app'
 * Debug mode: on
WARNING: This is a development server. Do not use it in a production deployment.
 * Running on http://127.0.0.1:5000
Press CTRL+C to quit
```

---

### 步骤 4: 启动前端服务

**打开新的命令行窗口：**

```bash
cd C:\AIProject\frontend
npm run dev
```

**预期输出：**
```
VITE v5.x.x  ready in xxx ms

➜  Local:   http://localhost:5173/
➜  Network: use --host to expose
```

---

### 步骤 5: 开始测试

#### 5.1 访问应用

打开浏览器访问：**http://localhost:5173**

应该会自动跳转到登录页面。

---

#### 5.2 测试用户注册

1. **点击"立即注册"链接**

2. **填写注册信息：**
   - 用户名：`testuser`
   - 邮箱：`test@example.com`
   - 密码：`test123`
   - 确认密码：`test123`

3. **点击"注册"按钮**

4. **预期结果：**
   - ✅ 显示"注册成功！"提示
   - ✅ 自动登录并跳转到主页（查询页面）
   - ✅ 左侧栏底部显示用户名"testuser"

---

#### 5.3 测试退出登录

1. **点击左侧栏底部的用户名**

2. **选择"退出登录"**

3. **确认退出**

4. **预期结果：**
   - ✅ 显示"已退出登录"提示
   - ✅ 自动跳转到登录页面

---

#### 5.4 测试用户登录

1. **填写登录信息：**
   - 用户名：`testuser` 或 `test@example.com`
   - 密码：`test123`

2. **点击"登录"按钮**

3. **预期结果：**
   - ✅ 显示"登录成功！"提示
   - ✅ 跳转到主页
   - ✅ 显示用户信息

---

#### 5.5 测试单词查询功能

1. **在查询页面输入单词：** `hello`

2. **填写剧情信息（可选）：**
   - 剧名：`Friends`
   - 剧集：`S01E01`
   - 剧情备注：`Joey 说的第一句话`

3. **点击"查询"按钮**

4. **预期结果：**
   - ✅ 显示单词翻译结果
   - ✅ 显示音标、释义、例句
   - ✅ 单词自动添加到学习计划

---

#### 5.6 测试单词库

1. **点击左侧栏"单词库"**

2. **预期结果：**
   - ✅ 显示刚才查询的单词
   - ✅ 显示查询次数、关联剧集等信息

---

#### 5.7 测试学习计划

1. **点击左侧栏"学习计划"**

2. **预期结果：**
   - ✅ 显示今日待复习单词
   - ✅ 显示学习进度统计

---

#### 5.8 测试统计功能

1. **点击左侧栏"学习统计"**

2. **预期结果：**
   - ✅ 显示总单词数
   - ✅ 显示今日查询数
   - ✅ 显示已掌握/学习中的单词数
   - ✅ 显示剧集统计

---

#### 5.9 测试数据隔离

1. **退出登录**

2. **注册新用户：**
   - 用户名：`testuser2`
   - 邮箱：`test2@example.com`
   - 密码：`test123`

3. **登录后查看单词库**

4. **预期结果：**
   - ✅ 单词库为空（看不到 testuser 的数据）
   - ✅ 查询新单词后，只能看到自己的数据

---

## ✅ 测试检查清单

### 认证功能
- [ ] 用户注册成功
- [ ] 用户登录成功（用户名）
- [ ] 用户登录成功（邮箱）
- [ ] 退出登录成功
- [ ] 未登录自动跳转登录页
- [ ] 已登录无法访问登录/注册页

### 业务功能
- [ ] 单词查询成功
- [ ] 单词库显示正确
- [ ] 学习计划创建成功
- [ ] 统计数据显示正确

### 数据隔离
- [ ] 不同用户看不到彼此的数据
- [ ] 切换用户后数据正确隔离

### 错误处理
- [ ] 错误的用户名/密码显示提示
- [ ] Token过期自动跳转登录
- [ ] 网络错误友好提示

---

## 🐛 可能遇到的问题

### 问题 1: 后端启动失败 - ModuleNotFoundError

**原因：** 依赖未安装

**解决：**
```bash
cd C:\AIProject\backend
pip install -r requirements.txt
```

---

### 问题 2: 前端无法连接后端

**检查：**
1. 后端是否在运行（http://localhost:5000）
2. CORS 配置是否正确
3. 浏览器控制台是否有错误

**解决：**
- 确保后端在 5000 端口运行
- 检查 backend/config.py 中的 CORS_ORIGINS 配置

---

### 问题 3: 401 Unauthorized 错误

**原因：** Token 无效或过期

**解决：**
1. 清除浏览器 localStorage
2. 重新登录

---

### 问题 4: 数据库错误

**原因：** 数据库结构不匹配

**解决：**
```bash
# Windows
del C:\AIProject\backend\instance\vocab_learner.db

# 重启后端服务
cd C:\AIProject\backend
python run.py
```

---

## 📞 测试完成后

完成测试后，请报告：

1. ✅ **通过的测试项**
2. ❌ **失败的测试项**（包含错误信息）
3. 🐛 **发现的问题**

---

## 🎯 预期测试结果

如果一切正常，您应该能够：

✅ 成功注册和登录
✅ 查询单词并查看翻译
✅ 在单词库中看到查询历史
✅ 查看学习计划和统计
✅ 不同用户数据完全隔离
✅ Token过期后自动跳转登录

---

**祝测试顺利！** 🚀
