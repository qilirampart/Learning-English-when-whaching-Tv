# AI 助手功能优化待办

## 🎉 已完成功能

### ✅ 核心功能
- [x] AI 用法解析 - 输入单词和剧名生成详细用法
- [x] AI 生成例句 - 生成多个例句
- [x] AI 记忆口诀 - 生成记忆技巧
- [x] Markdown 渲染 - 美观的内容展示
- [x] 深色模式适配
- [x] 保存到单词本 - 自动提取前两个例句保存

### ✅ 技术实现
- [x] iFlow API 接入 - 使用 Qwen3-Coder-Plus 模型
- [x] 前后端 API 对接
- [x] CORS 跨域配置
- [x] 超时时间优化（60秒）

---

## 🔧 待优化问题

### 1. 生成成功但无内容显示 ⭐⭐⭐

**问题描述**：
- 偶尔出现提示"生成成功"但内容区域为空
- 点击"重新生成"后通常能成功显示

**可能原因**：
- AI 返回的数据格式不一致
- 网络延迟导致响应不完整
- 前端渲染时机问题

**解决方案**：
- [ ] 添加更详细的错误处理
- [ ] 检查 AI 返回数据的完整性
- [ ] 添加加载状态提示
- [ ] 实现重试机制

---

### 2. API 调用超时 ⭐⭐

**问题描述**：
- AI 生成需要较长时间（15-30秒）
- 偶尔会超过原来的10秒超时限制

**已完成**：
- [x] 将超时时间增加到 60 秒

**待优化**：
- [ ] 添加实时进度提示
- [ ] 实现流式输出（SSE）
- [ ] 添加取消请求功能

---

### 3. 例句提取准确性 ⭐⭐⭐

**问题描述**：
- 目前使用正则表达式提取引号中的英文句子
- 可能遗漏某些格式的例句

**优化方案**：
- [ ] 改进例句提取算法
- [ ] 支持多种例句格式
- [ ] 允许用户手动选择例句
- [ ] 在保存前预览提取的例句

---

### 4. 用户体验优化 ⭐⭐⭐⭐

**待添加功能**：
- [ ] 历史记录 - 保存用户的 AI 查询历史
- [ ] 快速操作 - 常用单词快捷按钮
- [ ] 批量生成 - 一次生成多个单词的用法
- [ ] 导出功能 - 将 AI 内容导出为 PDF/Word
- [ ] 收藏功能 - 收藏特别有用的 AI 生成内容

---

### 5. AI 回复质量优化 ⭐⭐⭐⭐

**优化方向**：
- [ ] 优化 Prompt - 让 AI 生成更符合美剧场景的内容
- [ ] 添加示例 - 在 Prompt 中提供示例格式
- [ ] 温度参数调整 - 平衡创意性和准确性
- [ ] 多模型对比 - 测试不同模型的效果
- [ ] 内容格式化 - 确保输出格式统一

---

### 6. 性能优化 ⭐⭐

**优化点**：
- [ ] 缓存机制 - 相同单词不重复调用 AI
- [ ] 并发限制 - 防止同时发起过多请求
- [ ] 请求队列 - 管理多个 AI 请求
- [ ] 加载骨架屏 - 提升感知性能

---

### 7. 错误处理增强 ⭐⭐⭐

**需要改进**：
- [ ] 网络错误重试 - 自动重试失败的请求
- [ ] 详细错误信息 - 告诉用户具体哪里出错
- [ ] 降级方案 - AI 不可用时的备选方案
- [ ] 日志记录 - 记录错误以便排查

---

## 🚀 未来扩展功能

### 8. 高级 AI 功能 ⭐⭐⭐⭐⭐

- [ ] **AI 近义词辨析** - 对比多个近义词的用法
- [ ] **AI 对话练习** - 情景对话模拟
- [ ] **AI 语法纠错** - 检查用户输入的句子
- [ ] **AI 个性化推荐** - 根据学习历史推荐单词

### 9. 多模型支持 ⭐⭐⭐

- [ ] 支持切换不同的 AI 模型
- [ ] 对比不同模型的回复质量
- [ ] 让用户选择偏好的模型

### 10. AI 反馈机制 ⭐⭐⭐⭐

- [ ] 点赞/点踩 - 用户评价 AI 回复质量
- [ ] 报告问题 - 标记不准确的内容
- [ ] 优化 Prompt - 根据反馈改进提示词

---

## 📅 优先级排序

### P0 - 立即处理
1. ✅ 保存到单词本功能 - 已完成
2. ⏳ 生成成功但无内容问题 - 待调查

### P1 - 本周完成
3. 例句提取准确性优化
4. 用户体验优化（历史记录）

### P2 - 本月完成
5. AI 回复质量优化
6. 性能优化（缓存）

### P3 - 长期规划
7. 高级 AI 功能
8. 多模型支持

---

## 📝 开发笔记

### 技术选型
- **AI 服务**: iFlow 平台
- **模型**: Qwen3-Coder-Plus
- **Markdown 渲染**: marked.js
- **HTTP 客户端**: axios

### API 配置
```json
{
  "provider": "iFlow",
  "base_url": "https://apis.iflow.cn/v1",
  "model": "Qwen3-Coder-Plus",
  "api_key": "sk-765f4fdc95a1fcc249b3008091825e42"
}
```

### 可用模型列表
- Qwen3-Coder-Plus ✅ 当前使用
- Qwen3-Max ✅
- Qwen3-VL-Plus ✅
- Qwen3-Max-Preview ✅
- DeepSeek-R1 ✅

---

**最后更新**: 2025-11-17
**负责人**: AI 开发助手
**状态**: 进行中 🚧
